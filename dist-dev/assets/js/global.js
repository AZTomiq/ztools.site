document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("theme-toggle"),t=document.documentElement,o=t=>{e.textContent="dark"===t?"â˜€ï¸":"ðŸŒ™"};o(t.getAttribute("data-theme")),e.addEventListener("click",()=>{const e="dark"===t.getAttribute("data-theme")?"light":"dark";t.setAttribute("data-theme",e),localStorage.setItem("theme",e),o(e)}),console.log("ZTools Global JS Loaded"),"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/sw.js").then(e=>console.log("SW Registered!",e.scope)).catch(e=>console.error("SW Registration Failed",e))});document.querySelectorAll(".nav-item").forEach(e=>{const t=e.querySelector(".dropdown-toggle"),o=e.querySelector(".dropdown-menu");t&&o&&t.addEventListener("click",e=>{e.preventDefault(),e.stopPropagation(),document.querySelectorAll(".dropdown-menu.show").forEach(e=>{e!==o&&e.classList.remove("show")}),o.classList.toggle("show"),t.setAttribute("aria-expanded",o.classList.contains("show"))})}),document.querySelectorAll(".mega-header").forEach(e=>{e.addEventListener("click",t=>{t.stopPropagation(),t.preventDefault();const o="true"===e.getAttribute("aria-expanded");e.setAttribute("aria-expanded",!o)})}),document.addEventListener("click",e=>{e.target.closest(".nav-item")||document.querySelectorAll(".dropdown-menu.show").forEach(e=>{e.classList.remove("show");const t=e.parentElement.querySelector(".dropdown-toggle");t&&t.setAttribute("aria-expanded","false")})}),document.querySelectorAll(".tool-item, .mega-link").forEach(e=>{e.addEventListener("click",t=>{!function(e){if(!e)return;try{const t=e.split("/").filter(Boolean),o=t[t.length-1],r=Date.now();let a=JSON.parse(localStorage.getItem("ztools_recent")||"{}");a[o]=r,localStorage.setItem("ztools_recent",JSON.stringify(a));let n=JSON.parse(localStorage.getItem("ztools_usage")||"{}");n[o]=(n[o]||0)+1,localStorage.setItem("ztools_usage",JSON.stringify(n))}catch(e){console.error("Tracking error",e)}}(e.getAttribute("href")),e.classList.contains("mega-link")&&document.querySelectorAll(".dropdown-menu.show").forEach(e=>{e.classList.remove("show");const t=e.parentElement.querySelector(".dropdown-toggle");t&&t.setAttribute("aria-expanded","false")})})})});