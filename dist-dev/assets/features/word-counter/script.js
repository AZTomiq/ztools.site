const textInput=document.getElementById("text-input"),textOutput=document.getElementById("text-output"),elWords=document.getElementById("stat-words"),elChars=document.getElementById("stat-chars"),countWords=document.getElementById("count-words"),countChars=document.getElementById("count-chars"),countCharsNoSpace=document.getElementById("count-chars-no-space"),countSentences=document.getElementById("count-sentences"),countLines=document.getElementById("count-lines"),countParagraphs=document.getElementById("count-paragraphs"),readingTime=document.getElementById("reading-time"),speakingTime=document.getElementById("speaking-time"),detailLongest=document.getElementById("detail-longest"),detailShortest=document.getElementById("detail-shortest"),detailAvgWord=document.getElementById("detail-avg-word"),detailAvgSentence=document.getElementById("detail-avg-sentence"),keywordList=document.getElementById("keyword-list");let timeoutId;function analyzeText(){const t=textInput.value;if(!t)return void resetStats();const e=t.length,n=t.replace(/\s/g,"").length,o=t.match(/\b[-?(\w+)?]+\b/gi)||[],a=o.length,c=t.split(/[.!?]+/).filter(Boolean).length,r=t.split(/\r\n|\r|\n/).length,s=t.split(/\n\s*\n/).filter(t=>t.trim().length>0).length;elWords.textContent=`${a.toLocaleString()} words`,elChars.textContent=`${e.toLocaleString()} chars`,countWords.textContent=a.toLocaleString(),countChars.textContent=e.toLocaleString(),countCharsNoSpace.textContent=n.toLocaleString(),countSentences.textContent=c.toLocaleString(),countLines.textContent=r.toLocaleString(),countParagraphs.textContent=Math.max(1,s).toLocaleString();const i=Math.ceil(a/200),l=Math.ceil(a/130);if(readingTime.textContent=formatTime(i),speakingTime.textContent=formatTime(l),a>0){const t=[...o].sort((t,e)=>e.length-t.length),e=t[0]||"",n=t[t.length-1]||"",r=o.reduce((t,e)=>t+e.length,0)/a,s=c>0?a/c:0;detailLongest.textContent=e.length>15?e.substring(0,15)+"...":e,detailShortest.textContent=n,detailAvgWord.textContent=r.toFixed(1),detailAvgSentence.textContent=s.toFixed(1),analyzeKeywords(o)}}function analyzeKeywords(t){const e={},n=t.map(t=>t.toLowerCase()),o=new Set(["the","and","is","in","it","of","to","a","la","va","cua","trong","nhung","cho","voi"]);n.forEach(t=>{t.length>2&&!o.has(t)&&(e[t]=(e[t]||0)+1)});const a=Object.entries(e).sort((t,e)=>e[1]-t[1]).slice(0,5);keywordList.innerHTML="",0!==a.length?a.forEach(([e,n])=>{const o=document.createElement("li");o.innerHTML=`\n      <span class="keyword-word">${e}</span>\n      <span class="keyword-count">${n} (${Math.round(n/t.length*100)}%)</span>\n    `,keywordList.appendChild(o)}):keywordList.innerHTML='<li class="empty">No significant keywords found</li>'}function resetStats(){elWords.textContent="0 words",elChars.textContent="0 chars",countWords.textContent="0",countChars.textContent="0",countCharsNoSpace.textContent="0",countSentences.textContent="0",countLines.textContent="0",countParagraphs.textContent="0",readingTime.textContent="0s",speakingTime.textContent="0s",detailLongest.textContent="-",detailShortest.textContent="-",detailAvgWord.textContent="-",detailAvgSentence.textContent="-",keywordList.innerHTML='<li class="empty">Type something to see top keywords...</li>'}function formatTime(t){if(t<1)return"< 1m";if(t<60)return`${t}m`;return`${Math.floor(t/60)}h ${t%60}m`}function clearText(){textInput.value="",textInput.focus(),analyzeText()}function copyText(){textInput.value&&(textInput.select(),navigator.clipboard.writeText(textInput.value).then(()=>{const t=document.querySelector('button[onclick="copyText()"]').textContent;document.querySelector('button[onclick="copyText()"]').textContent="âœ… Copied",setTimeout(()=>{document.querySelector('button[onclick="copyText()"]').textContent=t},1500)}))}function removeExtraSpaces(){const t=textInput.value.replace(/[ \t]+/g," ").replace(/^\s+|\s+$/gm,"");textInput.value=t,analyzeText()}function convertCase(t){const e=textInput.value;if(!e)return;let n=e;switch(t){case"upper":n=e.toUpperCase();break;case"lower":n=e.toLowerCase();break;case"title":n=toTitleCase(e);break;case"sentence":n=toSentenceCase(e);break;case"camel":n=toCamelCase(e);break;case"kebab":n=toKebabCase(e);break;case"snake":n=toSnakeCase(e)}textInput.value=n,document.getElementById("case-select").value=""}function toTitleCase(t){return t.replace(/\w\S*/g,t=>t.charAt(0).toUpperCase()+t.substring(1).toLowerCase())}function toSentenceCase(t){return t.toLowerCase().replace(/(^\s*\w|[\.\!\?]\s*\w)/g,t=>t.toUpperCase())}function toCamelCase(t){return t.replace(/(?:^\w|[A-Z]|\b\w)/g,(t,e)=>0===e?t.toLowerCase():t.toUpperCase()).replace(/\s+/g,"")}function toKebabCase(t){return t.match(/[A-Z]{2,}(?=[A-Z][a-z]+[0-9]*|\b)|[A-Z]?[a-z]+[0-9]*|[A-Z]|[0-9]+/g).map(t=>t.toLowerCase()).join("-")}function toSnakeCase(t){return t.match(/[A-Z]{2,}(?=[A-Z][a-z]+[0-9]*|\b)|[A-Z]?[a-z]+[0-9]*|[A-Z]|[0-9]+/g).map(t=>t.toLowerCase()).join("_")}textInput.addEventListener("input",function(){clearTimeout(timeoutId),timeoutId=setTimeout(analyzeText,200)}),window.clearText=clearText,window.copyText=copyText,window.removeExtraSpaces=removeExtraSpaces,window.convertCase=convertCase;