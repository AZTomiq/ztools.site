document.addEventListener("DOMContentLoaded",function(){const e=document.getElementById("compound-form"),t=document.getElementById("btn-calculate"),n=document.getElementById("btn-reset"),o=document.getElementById("result-section");function r(e){return e&&parseInt(e.toString().replace(/\D/g,""),10)||0}function d(e){return new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(e)}["initial","contribution"].forEach(e=>{const t=document.getElementById(e);t&&t.addEventListener("input",e=>{let t=e.target.value.replace(/\D/g,"");t&&(e.target.value=parseInt(t,10).toLocaleString("vi-VN"))})}),t&&t.addEventListener("click",function(){const e=r(document.getElementById("initial").value),t=parseFloat(document.getElementById("rate").value)||0,n=parseInt(document.getElementById("years").value)||0,c=r(document.getElementById("contribution").value),a=parseInt(document.getElementById("frequency").value)||12;if(n<=0)return void alert("Please enter a valid number of years.");let l=e,u=e,i=0;const s=12*n,m=12/a,y=[];for(let e=1;e<=s;e++){if(l+=c,u+=c,e%m===0){const e=l*(t/100/a);l+=e,i+=e}e%12==0&&y.push({year:e/12,balance:l,intro:u,interest:i,contributed:u})}document.getElementById("res-future-value").textContent=d(l),document.getElementById("res-total-principal").textContent=d(u),document.getElementById("res-total-interest").textContent=d(i),function(e){const t=document.getElementById("breakdown-body");t.innerHTML="",e.forEach(e=>{const n=document.createElement("tr");n.innerHTML=`\n        <td>${e.year}</td>\n        <td style="font-weight:bold">${d(e.balance)}</td>\n        <td style="color:var(--success)">+${d(e.interest)}</td>\n        <td>${d(e.contributed)}</td>\n      `,t.appendChild(n)})}(y),o.classList.add("show")}),n&&n.addEventListener("click",()=>{e.reset(),o.classList.remove("show")})});