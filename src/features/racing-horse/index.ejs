<!-- title: <%= t('folkGames.games.racing_horse.title') %> - ZTools -->
<link rel="stylesheet" href="<%= asset('assets/css/folk-games.css') %>">

<section class="tool-container folk-bg-paper">
  <div class="page-header">
    <div style="display: flex; align-items: center; justify-content: center; gap: 0.75rem; margin-bottom: 0.5rem;">
      <h1 style="margin-bottom: 0;">üèá <%= t('folkGames.games.racing_horse.title') %>
      </h1>
      <a href="../" class="btn-folk" style="padding: 4px 12px; font-size: 0.8rem; text-decoration: none;">‚Üê <%=
          t('blog.back') %></a>
    </div>
    <p class="folk-red-dark">
      <%= t('folkGames.games.racing_horse.desc') %>
    </p>
  </div>

  <div class="racing-container">
    <!-- Horse Customization & Settings -->
    <div class="horse-settings folk-card" style="margin-bottom: 2rem;">
      <h3 style="text-align: center; color: var(--folk-red);">‚öôÔ∏è C√ÄI ƒê·∫∂T ƒêUA</h3>
      <div class="settings-grid"
        style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-top: 1rem;">
        <div class="setting-item">
          <label>S·ªë l∆∞·ª£ng ng·ª±a:</label>
          <input type="number" id="horse-count" value="4" min="2" max="8" class="btn-folk"
            style="background: white; color: black; border-color: var(--border-color); width: 60px;">
        </div>
        <div class="setting-item">
          <label>C∆∞·ª£c (xu):</label>
          <input type="number" id="horse-bet" value="100" min="10" step="50" class="btn-folk"
            style="background: white; color: black; border-color: var(--border-color); width: 100px;">
        </div>
        <div class="setting-item">
          <label>Ch·ªçn ng·ª±a th·∫Øng:</label>
          <select id="horse-choice" class="btn-folk"
            style="background: white; color: black; border-color: var(--border-color);">
            <option value="0">Ng·ª±a 1</option>
            <option value="1">Ng·ª±a 2</option>
            <option value="2">Ng·ª±a 3</option>
            <option value="3">Ng·ª±a 4</option>
          </select>
        </div>
      </div>
      <div style="text-align: center; margin-top: 1.5rem;">
        <button id="start-horse-race" class="btn-folk" style="padding: 0.8rem 3rem; font-size: 1.2rem;">üî• B·∫ÆT ƒê·∫¶U
          ƒêUA!</button>
      </div>
    </div>

    <div id="horse-wallet" class="folk-card"
      style="max-width: 250px; margin: 0 auto 1.5rem; text-align: center; padding: 0.5rem;">
      <span style="font-size: 0.8rem; color: var(--text-muted);">V√ç C·ª¶A B·∫†N: </span>
      <span id="horse-coins" style="font-weight: 800; color: var(--folk-red);">0</span>
    </div>

    <!-- Race Track -->
    <div class="horse-track" id="horse-track">
      <!-- Lanes will be generated here -->
      <div class="horse-finish-line"></div>
    </div>

    <div id="race-timer" class="race-timer" style="display: none;">3...</div>
  </div>
</section>

<!-- Award Modal -->
<div id="award-modal" class="modal">
  <div class="folk-card podium-card" style="text-align: center; min-width: 350px;">
    <h2 id="award-title" style="color: var(--folk-red);">üèÜ K·∫æT QU·∫¢ CU·ªòC ƒêUA</h2>
    <div class="winner-display">
      <div id="winner-horse-visual" class="winner-horse">üèá</div>
      <h3 id="winner-name">Ng·ª±a s·ªë 1</h3>
    </div>
    <p id="award-msg">Ch√∫c m·ª´ng b·∫°n ƒë√£ ƒë·∫°i th·∫Øng!</p>
    <div id="award-reward" style="font-size: 2.5rem; color: var(--folk-gold-dark); margin: 1rem 0; font-weight: 900;">
      +250 xu</div>
    <button id="close-award" class="btn-folk" style="width: 100%;">TI·∫æP T·ª§C</button>
  </div>
</div>

<style>
  .horse-track {
    position: relative;
    background: #4caf50;
    /* Green field */
    border: 8px solid var(--folk-wood);
    border-radius: 15px;
    padding: 10px 0;
    overflow-x: hidden;
    min-height: 200px;
    box-shadow: inset 0 0 50px rgba(0, 0, 0, 0.2);
  }

  .horse-finish-line {
    position: absolute;
    right: 80px;
    top: 0;
    bottom: 0;
    width: 20px;
    background: repeating-linear-gradient(0deg, white, white 10px, black 10px, black 20px);
    z-index: 1;
    border-left: 2px solid var(--folk-gold);
  }

  .horse-lane {
    position: relative;
    height: 80px;
    border-bottom: 2px dashed rgba(255, 255, 255, 0.4);
    display: flex;
    align-items: center;
  }

  .horse-lane:last-child {
    border-bottom: none;
  }

  .horse-racer {
    position: absolute;
    left: 20px;
    display: flex;
    align-items: center;
    gap: 15px;
    transition: left 0.1s linear;
    z-index: 5;
  }

  .horse-visual {
    position: relative;
    font-size: 3.5rem;
    filter: drop-shadow(0 3px 5px rgba(0, 0, 0, 0.3));
    transform: scaleX(-1);
    /* Flip horse to face right */
  }

  .horse-mane {
    position: absolute;
    top: 15%;
    left: 20%;
    width: 30%;
    height: 30%;
    border-radius: 50%;
    /* Themeable via JS */
  }

  .horse-label {
    background: rgba(0, 0, 0, 0.7);
    color: white;
    padding: 2px 8px;
    border-radius: 5px;
    font-size: 0.8rem;
    font-weight: bold;
    white-space: nowrap;
  }

  .race-timer {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 5rem;
    font-weight: 900;
    color: white;
    text-shadow: 0 0 20px rgba(0, 0, 0, 0.8);
    z-index: 1000;
  }

  /* Animations */
  @keyframes run {

    0%,
    100% {
      transform: translateY(0) rotate(0) scaleX(-1);
    }

    50% {
      transform: translateY(-5px) rotate(2deg) scaleX(-1);
    }
  }

  .horse-racer.running .horse-visual {
    animation: run 0.3s infinite;
  }

  .winner-display {
    padding: 2rem;
    background: rgba(255, 215, 0, 0.1);
    border-radius: 15px;
    margin: 1.5rem 0;
  }

  .winner-horse {
    font-size: 6rem;
    animation: float 2s infinite ease-in-out;
    transform: scaleX(-1);
  }
</style>

<!-- Include Core Assets -->
<script src="<%= asset('assets/features/folk-games/core.js') %>"></script>
<script src="<%= toolConfig._assets.js %>"></script>